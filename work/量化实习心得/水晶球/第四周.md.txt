# 5.2日 

## 任务一： 最优因子选取

根据当前所有因子，包括$cpr$, $\Delta cpr$, 波动率倾斜， 波动率近月\远月(认沽\认购)比值，以往均线（5日，20日），遍历上述因子所有任意组合情况，得到样本外预测准确率，根据准确率大小挑选出当前训练集和算法下的最优因子。

最终得到因子组合为：
- 近月认购IV / 次近月认购IV
- 近月认沽IV / 近月认购IV
- 短期认购期权波动率倾斜
- cpr
- cpr_delta

满分为5分，共6类分值(0-5)，设定3分及以上为乐观态度（理论上指数 涨幅 >0），2分及以下为谨慎态度（理论上指数 涨幅 <0）
计算出准确率为65.2%（短期数据，训练集为2016下半年，测试集为2017年所有数据）

## 任务二：分类模型调优
由于KNN受样本总量影响过大，svm和logistic分类区分度不强，最终选择决策树模型：CART算法，进行剪枝，取叶节点最小样本数为5，防止过拟合

## 任务三：交叉验证
对所选因子和模型效果进行交叉验证：
1. 根据所给日期，取改日期后所有数据
2. 对数据进行分割，分出70%作为训练集，30%作为测试集
3. 计算出预测准确率
4. 重复 步骤 2-3 n次，获取n次的准确率均值

根据交叉验证结果，发现上述因子组合和模型下的准确率稳定在56%左右，极少数情况会小与50%或大于62%。因此认为改模型准确率在56%左右，约等于兴业水晶球9分情况和3分情况下的准确率。


## 任务四：结果输出以及报表呈现

- 构建函数，输入日期，输出该日期的各项因子数值，分类得分（0或1）以及总分
- 输出历史日期中每个交易日的50etf涨幅，总分，每个因子的数值以及相应的分类得分
- 根据当天分值、因子数值、历史数据分析并预测下一交易日50etf指数的趋势，并制作每日报表发送至主管邮箱 





# 5.4日

## 任务一：沪深指数15分钟k线策略回测

### 策略内容：
当沪指(000001.sh)15分钟k线收盘价涨幅**超过**深成指(3990001.sz)15分钟k线收盘价涨幅**0.25**个百分点时，**做空**沪深300指数(000300)，否则做多

### 回测结果
回测平台：优矿(pro版)

回测日期：2010年1月4日~至今

回测结果：胜率为52.16%

纵轴为净获得的点数，代码在优矿上：沪深指数15分钟K线策略


## 任务二：50etf预测模型回测

### 平值期权
- 50etf看涨则当天开盘价买入认购，收盘价卖出认购
- 50etf看跌则当天开盘价买入认沽，收盘价卖出认沽

### 50etf现货回测
- 50etf看涨则当天开盘价买入现货，收盘价卖出现货

（由于时间关系还有一些瑕疵，具体我会下周在水晶球复现的报告里给出）


## 任务三：50etf报表输出改进
等今天数据出来之后，明天早晨会发到你的邮件上

















